'use strict';

var _must = require('must');

var _must2 = _interopRequireDefault(_must);

var _monad = require('potoo-lib/monad');

var _Actor = require('potoo-lib/Actor');

var _System = require('potoo-lib/System');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var noop = function noop() {};

var spawn = function spawn(mod) {
    return function (context) {
        return context.spawn(mod);
    };
};
var a1 = new _Actor.LocalT({ id: 'a1', start: noop });
var a2 = new _Actor.LocalT({ id: 'a2', start: noop });

var a3 = new _Actor.LocalT({
    id: 'a3',
    start: spawn(new _Actor.LocalT({
        id: 'a3a',
        start: spawn(new _Actor.LocalT({ id: 'a3aa', start: noop }))
    }))
});

var system = new _System.System().spawn(a1).spawn(a2).spawn(a3);

(0, _must2.default)(system.ops.length).be(3);
system.ops.forEach(function (t) {
    return (0, _must2.default)(t).be.instanceOf(_monad.Free);
});

system = system.tock(function (x) {
    return x;
});
(0, _must2.default)(system.actors.a1).be.instanceOf(_Actor.ActorL);
(0, _must2.default)(system.actors.a2).be.instanceOf(_Actor.ActorL);
(0, _must2.default)(system.actors.a3).be.instanceOf(_Actor.ActorL);

console.log(system);
system = system.tick();
(0, _must2.default)(system.ops.length).be(1);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9vbGQvc3Bhd25UaHJlZUFjdG9ycy5qcyJdLCJuYW1lcyI6WyJub29wIiwic3Bhd24iLCJjb250ZXh0IiwibW9kIiwiYTEiLCJpZCIsInN0YXJ0IiwiYTIiLCJhMyIsInN5c3RlbSIsIm9wcyIsImxlbmd0aCIsImJlIiwiZm9yRWFjaCIsInQiLCJpbnN0YW5jZU9mIiwidG9jayIsIngiLCJhY3RvcnMiLCJjb25zb2xlIiwibG9nIiwidGljayJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7OztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsSUFBTUEsT0FBTyxTQUFQQSxJQUFPLEdBQU0sQ0FBRSxDQUFyQjs7QUFHUSxJQUFJQyxRQUFRLFNBQVJBLEtBQVE7QUFBQSxXQUFPO0FBQUEsZUFBV0MsUUFBUUQsS0FBUixDQUFjRSxHQUFkLENBQVg7QUFBQSxLQUFQO0FBQUEsQ0FBWjtBQUNBLElBQUlDLEtBQUssa0JBQVcsRUFBRUMsSUFBSSxJQUFOLEVBQVlDLE9BQU9OLElBQW5CLEVBQVgsQ0FBVDtBQUNBLElBQUlPLEtBQUssa0JBQVcsRUFBRUYsSUFBSSxJQUFOLEVBQVlDLE9BQU9OLElBQW5CLEVBQVgsQ0FBVDs7QUFFQSxJQUFJUSxLQUFLLGtCQUFXO0FBQ2hCSCxRQUFJLElBRFk7QUFFaEJDLFdBQU9MLE1BQU0sa0JBQVc7QUFDcEJJLFlBQUksS0FEZ0I7QUFFcEJDLGVBQU9MLE1BQU0sa0JBQVcsRUFBRUksSUFBSSxNQUFOLEVBQWNDLE9BQU9OLElBQXJCLEVBQVgsQ0FBTjtBQUZhLEtBQVgsQ0FBTjtBQUZTLENBQVgsQ0FBVDs7QUFRQSxJQUFJUyxTQUFTLHFCQUFhUixLQUFiLENBQW1CRyxFQUFuQixFQUF1QkgsS0FBdkIsQ0FBNkJNLEVBQTdCLEVBQWlDTixLQUFqQyxDQUF1Q08sRUFBdkMsQ0FBYjs7QUFFQSxvQkFBS0MsT0FBT0MsR0FBUCxDQUFXQyxNQUFoQixFQUF3QkMsRUFBeEIsQ0FBMkIsQ0FBM0I7QUFDQUgsT0FBT0MsR0FBUCxDQUFXRyxPQUFYLENBQW1CO0FBQUEsV0FBSyxvQkFBS0MsQ0FBTCxFQUFRRixFQUFSLENBQVdHLFVBQVgsYUFBTDtBQUFBLENBQW5COztBQUVBTixTQUFTQSxPQUFPTyxJQUFQLENBQVk7QUFBQSxXQUFLQyxDQUFMO0FBQUEsQ0FBWixDQUFUO0FBQ0Esb0JBQUtSLE9BQU9TLE1BQVAsQ0FBY2QsRUFBbkIsRUFBdUJRLEVBQXZCLENBQTBCRyxVQUExQjtBQUNBLG9CQUFLTixPQUFPUyxNQUFQLENBQWNYLEVBQW5CLEVBQXVCSyxFQUF2QixDQUEwQkcsVUFBMUI7QUFDQSxvQkFBS04sT0FBT1MsTUFBUCxDQUFjVixFQUFuQixFQUF1QkksRUFBdkIsQ0FBMEJHLFVBQTFCOztBQUVBSSxRQUFRQyxHQUFSLENBQVlYLE1BQVo7QUFDQUEsU0FBU0EsT0FBT1ksSUFBUCxFQUFUO0FBQ0Esb0JBQUtaLE9BQU9DLEdBQVAsQ0FBV0MsTUFBaEIsRUFBd0JDLEVBQXhCLENBQTJCLENBQTNCIiwiZmlsZSI6InNwYXduVGhyZWVBY3RvcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbXVzdCBmcm9tICdtdXN0JztcbmltcG9ydCB7IEZyZWUgfSBmcm9tICdwb3Rvby1saWIvbW9uYWQnO1xuaW1wb3J0IHsgTG9jYWxULCBBY3RvckwgfSBmcm9tICdwb3Rvby1saWIvQWN0b3InO1xuaW1wb3J0IHsgU3lzdGVtLCBTcGF3biB9IGZyb20gJ3BvdG9vLWxpYi9TeXN0ZW0nO1xuXG5jb25zdCBub29wID0gKCkgPT4ge307XG5cblxuICAgICAgICBsZXQgc3Bhd24gPSBtb2QgPT4gY29udGV4dCA9PiBjb250ZXh0LnNwYXduKG1vZCk7XG4gICAgICAgIGxldCBhMSA9IG5ldyBMb2NhbFQoeyBpZDogJ2ExJywgc3RhcnQ6IG5vb3AgfSk7XG4gICAgICAgIGxldCBhMiA9IG5ldyBMb2NhbFQoeyBpZDogJ2EyJywgc3RhcnQ6IG5vb3AgfSk7XG5cbiAgICAgICAgbGV0IGEzID0gbmV3IExvY2FsVCh7XG4gICAgICAgICAgICBpZDogJ2EzJyxcbiAgICAgICAgICAgIHN0YXJ0OiBzcGF3bihuZXcgTG9jYWxUKHtcbiAgICAgICAgICAgICAgICBpZDogJ2EzYScsXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHNwYXduKG5ldyBMb2NhbFQoeyBpZDogJ2EzYWEnLCBzdGFydDogbm9vcCB9KSlcbiAgICAgICAgICAgIH0pKVxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgc3lzdGVtID0gbmV3IFN5c3RlbSgpLnNwYXduKGExKS5zcGF3bihhMikuc3Bhd24oYTMpO1xuXG4gICAgICAgIG11c3Qoc3lzdGVtLm9wcy5sZW5ndGgpLmJlKDMpO1xuICAgICAgICBzeXN0ZW0ub3BzLmZvckVhY2godCA9PiBtdXN0KHQpLmJlLmluc3RhbmNlT2YoRnJlZSkpO1xuXG4gICAgICAgIHN5c3RlbSA9IHN5c3RlbS50b2NrKHggPT4geCk7XG4gICAgICAgIG11c3Qoc3lzdGVtLmFjdG9ycy5hMSkuYmUuaW5zdGFuY2VPZihBY3RvckwpO1xuICAgICAgICBtdXN0KHN5c3RlbS5hY3RvcnMuYTIpLmJlLmluc3RhbmNlT2YoQWN0b3JMKTtcbiAgICAgICAgbXVzdChzeXN0ZW0uYWN0b3JzLmEzKS5iZS5pbnN0YW5jZU9mKEFjdG9yTCk7XG5cbiAgICAgICAgY29uc29sZS5sb2coc3lzdGVtKVxuICAgICAgICBzeXN0ZW0gPSBzeXN0ZW0udGljaygpO1xuICAgICAgICBtdXN0KHN5c3RlbS5vcHMubGVuZ3RoKS5iZSgxKTtcblxuXG4iXX0=